# 🤖 子代理系统指南

> **注意**：子代理仅在 **Claude Code CLI** 中可用。其他平台（Copilot/Cursor/ChatGPT）的功能由主角色提供。

---

## 🎯 什么是子代理系统？

子代理系统是 Claude Code CLI 的高级特性，允许创建专门化的 AI 角色来处理特定任务。

**核心优势**：
- 🎯 **专注性**：每个子代理专注于特定领域
- 🔒 **隔离上下文**：独立的上下文窗口，避免干扰
- 🎨 **个性化**：每个子代理有独特的风格和方法
- 🔧 **最小权限**：只授予必要的工具权限

**跨平台兼容性**：
- ✅ 所有功能在主 CLAUDE.md 中都有实现
- ✅ 通过自然语言触发同样的功能
- ✅ Claude Code CLI 用户获得增强的专门化体验

---

## 📚 可用子代理列表

### 1. Framework Expert（框架专家）

**触发条件**：
- "推荐框架"
- "选择框架"
- "用什么框架"

**专长**：
- 快速识别问题类型
- 推荐合适的框架组合
- 提供框架使用指导

**工具权限**：
- `read_file` - 读取框架文档
- `grep` - 搜索框架信息
- `codebase_search` - 检索相关内容

**输出风格**：
- 结构化推荐
- 框架对比
- 使用建议

**文件位置**：`.claude/agents/framework-expert.md`

---

### 2. Case Advisor（案例顾问）

**触发条件**：
- "有没有类似案例"
- "参考案例"
- "看看别人怎么做的"

**专长**：
- 快速检索相关案例
- 提取案例关键洞见
- 指导如何应用到当前问题

**工具权限**：
- `read_file` - 读取案例文件
- `grep` - 搜索案例内容
- `codebase_search` - 检索相关案例

**输出风格**：
- 案例摘要
- 洞见提炼
- 应用指导

**文件位置**：`.claude/agents/case-advisor.md`

---

### 3. Quality Reviewer（质量审查员）

**触发条件**：
- "审查"
- "检查质量"
- "review"

**专长**：
- 检查MECE原则应用
- 验证数据支撑
- 评估洞见深度
- 审查可执行性

**工具权限**：
- `read_file` - 读取待审查文件

**输出风格**：
- 评分报告
- 问题清单
- 改进建议

**文件位置**：`.claude/agents/quality-reviewer.md`

---

### 4. Methodology Teacher（方法论教练）

**触发条件**：
- "怎么用MECE"
- "解释金字塔原则"
- "什么是假设驱动"

**专长**：
- 深入浅出讲解方法论
- 提供丰富示例
- 指导实践应用
- 识别常见错误

**工具权限**：
- `read_file` - 读取方法论文档

**输出风格**：
- 教学式讲解
- 错误vs正确对比
- 练习建议

**文件位置**：`.claude/agents/methodology-teacher.md`

---

## 🔄 子代理调用流程

### Claude Code CLI

**自动触发**：
```
用户："推荐框架，我需要分析市场进入"
→ Claude识别触发词"推荐框架"
→ 自动调用 framework-expert 子代理
→ 子代理读取memory/frameworks/CLAUDE.md
→ 返回专业的框架推荐
→ 主代理整合输出
```

**手动调用**（如果支持）：
```
claude invoke framework-expert "市场进入分析"
```

### 其他平台（Copilot/Cursor/ChatGPT）

**功能等效实现**：
```
用户："推荐框架，我需要分析市场进入"
→ 主 CLAUDE.md 识别触发词
→ 读取memory/frameworks/CLAUDE.md
→ 执行相同的推荐逻辑
→ 返回相同格式的输出
```

**区别**：
- Claude Code CLI：独立的子代理上下文
- 其他平台：主角色内部的功能模块

**效果**：
- 输出格式完全一致
- 分析质量完全一致
- 用户体验基本一致

---

## 🎨 子代理特色

### 框架专家（蓝色）

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【框架专家建议】🔵
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1️⃣ 首选：波特五力
2️⃣ 补充：SWOT分析
3️⃣ 可选：安索夫矩阵

🔗 推荐使用顺序：...
```

### 案例顾问（绿色）

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【案例顾问建议】🟢
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📚 找到 2 个相关案例：

### 案例1：在线教育SaaS市场进入
...
```

### 质量审查员（红色）

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【质量审查报告】🔴
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

总体评分：85/100 良好 ⭐⭐⭐⭐

⚠️  发现 3 个问题需要修改...
```

### 方法论教练（紫色）

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【方法论教练】MECE原则 🟣
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📚 是什么
MECE = Mutually Exclusive, Collectively Exhaustive
...
```

---

## 🛠️ 子代理开发指南

### 创建新子代理

**步骤1：创建配置文件**

在 `.claude/agents/` 下创建 Markdown 文件：

```markdown
---
name: my-agent
description: 当用户说"触发词"时自动调用
model: sonnet
color: blue
tools:
  - read_file
---

# 你是[角色名称]

角色定义...

## 工作流程
...
```

**步骤2：定义触发条件**

在 `description` 中明确说明触发条件：
```yaml
description: 当用户说"推荐框架"、"选择框架"或"用什么框架"时自动调用
```

**步骤3：限制工具权限**

使用 `tools` 数组限制权限（最小权限原则）：
```yaml
tools:
  - read_file  # 只能读文件
  - grep       # 可以搜索
  # 不授予 write, run_terminal_cmd 等危险权限
```

**步骤4：确保跨平台兼容**

在文件末尾添加跨平台兼容说明：
```markdown
## 跨平台兼容

在所有平台上，当用户说以下内容时，都应该触发类似的功能：
- "触发词1"
- "触发词2"

非 Claude Code CLI 平台通过在主 CLAUDE.md 中的自然语言触发机制实现。
```

### 子代理设计原则

1. **专注性**：
   - 一个子代理只做一类事情
   - 明确的职责边界

2. **独立性**：
   - 可以独立完成任务
   - 不依赖其他子代理

3. **安全性**：
   - 最小权限原则
   - 只授予必要的工具

4. **跨平台**：
   - 功能在主角色中有等效实现
   - 提供自然语言触发方式

---

## 📊 对比表

| 特性 | Claude Code CLI（子代理） | 其他平台（主角色） |
|------|------------------------|-----------------|
| **上下文隔离** | ✅ 独立上下文 | ❌ 共享上下文 |
| **专门化角色** | ✅ 独立角色定义 | ⚠️ 功能模块 |
| **工具权限** | ✅ 精细控制 | ⚠️ 主角色权限 |
| **触发方式** | ⚡ 自动识别 | 📝 自然语言 |
| **输出格式** | ✅ 完全一致 | ✅ 完全一致 |
| **功能完整性** | ✅ 完整 | ✅ 完整 |

---

## ❓ 常见问题

### Q1：为什么我的平台没有子代理？

**A**：子代理是 Claude Code CLI 的特性。其他平台通过主 CLAUDE.md 中的功能模块实现相同功能。

### Q2：子代理和主角色的输出一样吗？

**A**：完全一样！子代理只是专门化的实现方式，输出格式和质量完全一致。

### Q3：可以创建自己的子代理吗？

**A**：可以！参考"子代理开发指南"创建自定义子代理。

### Q4：子代理会占用更多token吗？

**A**：
- Claude Code CLI：子代理有独立上下文，不计入主代理token
- 其他平台：使用主角色，token计入主对话

---

## 📚 相关文档

- **自定义命令**：`../commands/README.md`
- **模块化记忆**：`../../memory/README.md`
- **核心角色**：`../../CLAUDE.md`

---

**最后更新**：2025年11月  
**版本**：v1.0  
**子代理数量**：4个（可扩展）

